<script>
	import { panes, activePane, isSmallWindow } from './globals'
	import { fly, fade } from 'svelte/transition'
	import { backOut, sineOut } from 'svelte/easing'
	import { clickOutside } from '$lib/actions'
	import CloseIcon from '../lib/icons/CloseIcon.svelte'

	const hidePane = () => ($activePane = panes.none)

	$: arrowXpos = `--x:${$isSmallWindow ? 5.75 : 5.75}rem;`
</script>

<div class="background" transition:fade={{ duration: 200 }}>
	<div class="marginwrapper">
		<div
			class="messagePane"
			in:fly={{ y: -100, duration: 300, easing: backOut }}
			out:fly={{ y: -100, duration: 200, easing: sineOut }}
		>
			<div class="content" use:clickOutside on:clickoutside={hidePane}>
				<header class="messagesHeader" style={arrowXpos}>
					<ul>
						<li>
							<h6>Inställningar</h6>
						</li>
						<li
							on:click|stopPropagation={hidePane}
							title="Stäng meddelanden"
						>
							<CloseIcon />
						</li>
					</ul>
				</header>
				<div class="messagesBody">
					<ul>
						<li>
							<svg
								width="20"
								height="20"
								viewBox="0 0 20 20"
								fill="none"
								xmlns="http://www.w3.org/2000/svg"
							>
								<path
									d="M12 9.00031H16V7.00031H12V9.00031Z"
									fill="#005AA0"
								/>
								<path
									d="M16 12.0003H12V10.0003H16V12.0003Z"
									fill="#005AA0"
								/>
								<path
									fill-rule="evenodd"
									clip-rule="evenodd"
									d="M3.8 3C2.533 3 1.472 3.851 1.128 5.008C1.053 5.261 1 5.523 1 5.8V14.2C1 15.8128 2.3125 17 3.8 17H16.2C17.8125 17 19 15.7503 19 14.2V5.8C19 4.256 17.744 3 16.2 3H3.8ZM17 14.2C17 14.5941 16.6562 15 16.2 15C8.52084 15.0209 4.39026 15.021 3.80827 15.0003H4.5C4.5 13.3574 5.82067 12.0229 7.4583 12.0006L7.5 12.0009L7.54171 12.0006C9.17934 12.0229 10.5 13.3574 10.5 15.0003H12.5C12.5 13.1475 11.4922 11.53 9.99481 10.6662C10.3138 10.1896 10.5 9.61673 10.5 9.00088C10.5 7.34518 9.15539 6.00031 7.5 6.00031C5.84503 6.00031 4.5 7.34533 4.5 9.00088C4.5 9.61668 4.68621 10.1895 5.00529 10.6662C4.14011 11.1652 3.43835 11.9159 3 12.8182V5.8C3 5.359 3.359 5 3.8 5H16.2C16.641 5 17 5.359 17 5.8V14.2ZM7.53107 10.0004L7.5 10.0003L7.46896 10.0004C6.93283 9.98388 6.5 9.54094 6.5 9.00088C6.5 8.4499 6.9496 8.00031 7.5 8.00031C8.05073 8.00031 8.5 8.44966 8.5 9.00088C8.5 9.54117 8.06749 9.98388 7.53107 10.0004Z"
									fill="#005AA0"
								/>
							</svg>
							<a href="#">Kontaktuppgifter</a>
						</li>
						<li>
							<svg
								width="21"
								height="20"
								viewBox="0 0 21 20"
								fill="none"
								xmlns="http://www.w3.org/2000/svg"
							>
								<path
									fill-rule="evenodd"
									clip-rule="evenodd"
									d="M10.8379 7.82327C9.9534 7.82327 9.31785 7.7677 8.56394 7.54168C7.38762 7.18902 6.44699 6.49453 5.888 5.38217L7.66841 4.48191C8.18512 5.51012 9.22964 5.82327 10.8379 5.82327H17.9787L18.2388 6.42582C18.7219 7.5447 18.9745 8.7555 18.9745 10C18.9745 14.9706 14.9575 19 10.0023 19C5.04703 19 1.03003 14.9706 1.03003 10C1.03003 5.02944 5.04703 1 10.0023 1C12.2962 1 14.4573 1.86839 16.105 3.40252L14.7485 4.86834C13.4661 3.67428 11.7881 3 10.0023 3C6.14819 3 3.02386 6.13401 3.02386 10C3.02386 13.866 6.14819 17 10.0023 17C13.8563 17 16.9806 13.866 16.9806 10C16.9806 9.25042 16.8635 8.5184 16.637 7.82327H10.8379Z"
									fill="#005AA0"
								/>
								<path
									fill-rule="evenodd"
									clip-rule="evenodd"
									d="M14.9151 10.5021H13.4197C13.4197 10.1793 13.1448 9.91016 12.7968 9.91016C12.4487 9.91016 12.1738 10.1793 12.1738 10.5021H10.6785C10.6785 9.34264 11.6309 8.41016 12.7968 8.41016C13.9627 8.41016 14.9151 9.34264 14.9151 10.5021Z"
									fill="#005AA0"
								/>
								<path
									fill-rule="evenodd"
									clip-rule="evenodd"
									d="M9.43068 10.5021H7.93531C7.93531 10.1793 7.66041 9.91016 7.31238 9.91016C6.96436 9.91016 6.68946 10.1793 6.68946 10.5021H5.19409C5.19409 9.34264 6.14648 8.41016 7.31238 8.41016C8.47829 8.41016 9.43068 9.34264 9.43068 10.5021Z"
									fill="#005AA0"
								/>
								<path
									fill-rule="evenodd"
									clip-rule="evenodd"
									d="M5.96362 14.0863L7.3578 12.6565C8.06687 13.3522 9.02735 13.7506 10.0564 13.7506C11.0875 13.7506 12.0498 13.3506 12.7592 12.6523L14.1556 14.0799C13.0759 15.1426 11.6133 15.7506 10.0564 15.7506C8.50265 15.7506 7.04279 15.1451 5.96362 14.0863Z"
									fill="#005AA0"
								/>
							</svg>
							<a href="#">Saker vi behöver veta om dig</a>
						</li>
						<li>
							<svg
								width="20"
								height="20"
								viewBox="0 0 20 20"
								fill="none"
								xmlns="http://www.w3.org/2000/svg"
							>
								<path
									fill-rule="evenodd"
									clip-rule="evenodd"
									d="M19 17V3H1V17H19ZM14.2328 10.5L17 13.6625V6.05921L10.0426 12.0968L3 6.05281V13.6625L5.76721 10.5L7.2328 11.8609L4.48609 15H15.5139L12.7672 11.8609L14.2328 10.5ZM15.1538 5L10.0384 9.37494L4.86066 5H15.1538Z"
									fill="#005AA0"
								/>
							</svg>
							<a href="#">Notiser och meddelanden</a>
						</li>
						<li>
							<svg
								width="21"
								height="20"
								viewBox="0 0 21 20"
								fill="none"
								xmlns="http://www.w3.org/2000/svg"
							>
								<path
									d="M12.5991 2H8.13278L7.53284 5.82079H8.29944C8.71607 5.82079 9.11603 5.63564 9.28268 5.3495C9.33268 5.26535 9.36601 5.18119 9.36601 5.11386C9.36601 4.96238 9.26602 4.82772 9.14936 4.7604C8.84939 4.54158 8.79939 4.30594 8.79939 4.13762V4.05347C8.86605 3.6495 9.39934 3.21188 10.1159 3.21188C10.5492 3.21188 10.8659 3.31287 11.0659 3.49802C11.2325 3.66634 11.3158 3.90198 11.2658 4.13762C11.1992 4.42376 10.9159 4.65941 10.7492 4.77723C10.3159 5.0802 10.3659 5.3495 10.3993 5.43366C10.4826 5.66931 10.8325 5.82079 11.0992 5.82079H12.2658C13.8489 5.83762 14.6989 6.56139 14.4156 8.27822C14.1656 9.8604 12.9657 10.5505 11.5325 10.5673L10.9325 14.2198H11.7658C15.3155 14.2198 18.1986 11.9139 18.7819 8.29505C19.4985 3.80099 16.6654 2 12.5991 2Z"
									fill="#005AA0"
								/>
								<path
									fill-rule="evenodd"
									clip-rule="evenodd"
									d="M3.38323 15.8525H1.58339L1.1001 18.9495H3.14992C3.71654 18.9495 4.14983 18.5792 4.23316 18.0743C4.29982 17.6703 4.13317 17.4178 3.69987 17.2495C4.04984 17.1149 4.23316 16.896 4.28315 16.6099C4.33315 16.2396 4.14983 15.8525 3.38323 15.8525ZM3.31657 16.7446C3.28324 16.9634 3.11659 17.1485 2.76662 17.1485H2.44998L2.5833 16.3406H2.89994C3.24991 16.3406 3.3499 16.5089 3.31657 16.7446ZM3.18325 18.0406C3.13325 18.3436 2.93327 18.4951 2.56664 18.4951H2.25L2.38332 17.6198H2.73329C3.08326 17.6198 3.21658 17.7881 3.18325 18.0406Z"
									fill="#005AA0"
								/>
								<path
									d="M10.7326 15.8525H11.6658L11.4325 17.3842L12.3324 16.5594H13.4823L12.3324 17.5861L13.249 18.9663H12.0658L11.3492 17.8554H11.3325L11.1659 18.9663H10.2326L10.7326 15.8525Z"
									fill="#005AA0"
								/>
								<path
									d="M15.1155 15.8525H14.0323L13.549 18.9495H14.6322L15.1155 15.8525Z"
									fill="#005AA0"
								/>
								<path
									fill-rule="evenodd"
									clip-rule="evenodd"
									d="M17.1654 15.8525H15.6322L15.1655 18.9663H16.882C17.9153 18.9663 18.4819 18.1584 18.5819 17.4515C18.6986 16.7277 18.3486 15.8525 17.1654 15.8525ZM17.532 17.4178C17.4487 17.9733 17.1487 18.2257 16.6321 18.2257L16.3488 18.2426L16.5987 16.6099H16.8987C17.4653 16.6099 17.5986 17.0139 17.532 17.4178Z"
									fill="#005AA0"
								/>
								<path
									d="M8.54946 16.5594H7.61621L7.23291 18.9495H8.16616L8.38281 17.5525C8.51613 17.3842 8.64945 17.3 8.79944 17.3C8.98276 17.3 9.04942 17.4178 9.01609 17.6535L8.8161 18.9664H9.74936L9.99933 17.3842C10.0827 16.8456 9.83268 16.5258 9.31606 16.5258C9.01609 16.5258 8.79944 16.6267 8.49947 16.8792L8.54946 16.5594Z"
									fill="#005AA0"
								/>
								<path
									fill-rule="evenodd"
									clip-rule="evenodd"
									d="M6.73292 18.9832C6.2663 19.0168 6.03299 18.9663 5.93299 18.7644C5.68302 18.9158 5.41637 19 5.1164 19C4.58311 19 4.3998 18.7307 4.44979 18.4109C4.46646 18.2594 4.54978 18.1248 4.69977 18.0069C4.85303 17.8703 5.13797 17.7978 5.41212 17.728C5.64475 17.6688 5.86961 17.6115 5.99966 17.5188C6.01632 17.3 5.93299 17.2158 5.66635 17.2158C5.34971 17.2158 5.09973 17.3168 4.64977 17.6198L4.74977 16.9129C5.13307 16.6267 5.4997 16.5089 5.93299 16.5089C6.48295 16.5089 6.96624 16.7277 6.86625 17.3337L6.76625 18.0238C6.73292 18.2594 6.73292 18.3436 6.99957 18.3436L6.73292 18.9832ZM5.93299 17.9228C5.84908 17.9736 5.74075 18.0055 5.63196 18.0375C5.41668 18.1009 5.19961 18.1648 5.1664 18.3772C5.14973 18.5287 5.23306 18.6465 5.38304 18.6465C5.53303 18.6465 5.71635 18.5792 5.84967 18.4782C5.8357 18.4359 5.84515 18.3818 5.85838 18.3059L5.86633 18.2594L5.93299 17.9228Z"
									fill="#005AA0"
								/>
								<path
									d="M6.64962 6.14057H7.44955L6.71628 10.8703C6.44964 12.6376 6.24965 13.9841 6.23299 14.2198H1.83337C1.8719 13.963 2.12772 12.3138 2.39826 10.5698C2.71289 8.54152 3.04742 6.38492 3.08326 6.14057H3.89986C4.41648 6.14057 4.89977 5.8881 5.13308 5.5178C5.34973 5.1475 5.26641 4.76038 4.91644 4.49107C4.79978 4.40691 4.64979 4.27226 4.68312 4.08711C4.71645 3.85147 5.11642 3.51483 5.68304 3.51483C6.01634 3.51483 6.28298 3.59899 6.39964 3.71681C6.49963 3.8178 6.53296 3.93562 6.49963 4.07028C6.48297 4.20493 6.33298 4.37325 6.11633 4.52473C5.49972 4.96236 5.59971 5.41681 5.64971 5.55147C5.79969 5.93859 6.28298 6.14057 6.64962 6.14057Z"
									fill="#005AA0"
								/>
							</svg>
							<a href="#">BankID</a>
						</li>
						<li>
							<svg
								width="20"
								height="20"
								viewBox="0 0 20 20"
								fill="none"
								xmlns="http://www.w3.org/2000/svg"
							>
								<path
									fill-rule="evenodd"
									clip-rule="evenodd"
									d="M7.041 17.452L7.382 17.032C9.7 17.684 12.251 16.839 13.807 14.937C15.889 12.379 15.532 8.513 12.915 6.371L12.439 6.014L14.603 3.479L15.041 3.808C16.904 5.288 18 7.534 18 10C18 14.438 14.438 18 10 18C9.014 18 8.027 17.836 7.041 17.452ZM5.014 16.247C3.096 14.712 2 12.411 2 10C2 5.562 5.562 2 10 2C11.151 2 12.246 2.219 13.233 2.712L12.872 3.11C10.384 2.336 7.75 3.042 6.133 5.062C4.051 7.68 4.468 11.428 7.085 13.629L7.561 13.986L5.397 16.575L5.014 16.247Z"
									fill="#005AA0"
								/>
							</svg>
							<a href="#">Swish</a>
						</li>
					</ul>
				</div>
			</div>
		</div>
	</div>
</div>

<style lang="scss">
	.background {
		inset: 0;
		background: rgba(34, 34, 34, 0.25);
		position: fixed;
		margin: var(--headerHeight) auto 0;
	}
	.marginwrapper {
		max-width: calc(1140px);
		margin: auto;
		padding-left: 1rem;
	}
	.messagePane {
		--headerHeight: 3.75rem;
		max-width: calc(16rem);

		margin: 1rem 1rem 1rem auto;

		filter: drop-shadow(0px 6px 6px rgba(0, 0, 0, 0.1))
			drop-shadow(0px 1px 1px rgba(0, 0, 0, 0.1));

		.content {
			background: var(--white);
			border-radius: 4px;
			overflow: hidden;
			//max-height: calc(100mvh - var(--headerHeight) - 1rem);

			.messagesHeader {
				--x: 0;
				&:before {
					// arrow
					content: '';
					width: 0;
					height: 0;
					border-style: solid;
					border-width: 0 0.5rem 1rem 0.5rem;
					border-color: transparent transparent var(--white)
						transparent;
					position: absolute;
					top: -0.875rem;
					right: var(--x);
				}

				ul {
					margin: 0%;
					padding: 0.5rem;
					padding-bottom: 0;
					display: flex;
					gap: 0.75rem;

					li {
						&:first-child {
							flex: 1;
						}
						list-style: none;
						h4 {
							margin-bottom: 0;
							@media (max-width: 800px) {
								font-size: 1.125rem;
							}
						}
						h6 {
							margin-left: 0.25rem;
							display: inline;
						}
						a {
							display: flex;
							align-items: center;
							gap: 0.5rem;
							&:hover {
								background: none;
							}
						}
					}
				}
			}

			.messagesBody {
				display: flex;
				transition: transform 0.3s;
				//min-height: 30rem;
				//@media (max-width: 800px) {
				//width: 200%;
				&.messageActive {
					transform: translateX(-50%);
				}

				ul {
					margin: 0;
					padding: 0;
					list-style: none;
					width: 100%;

					li {
						font-family: 'Intro Cond';
						padding: 0.5rem 0.7rem;
						display: flex;
						gap: 0.5rem;
						align-items: center;

						transition: background 0.3s;

						&:hover {
							background: var(--cloud);
						}
						a {
							flex: 1;
							padding-top: 2px;
							background: none;
						}
					}
				}
			}
		}
	}
</style>
